# üí≥ –¢”©–ª–±”©—Ä –¢–µ—Å—Ç –•–∏–π—Ö –ó–∞–∞–≤–∞—Ä

## üéØ Localhost –¥—ç—ç—Ä QPay Webhook –ê—Å—É—É–¥–∞–ª

### ‚ö†Ô∏è –ê—Å—É—É–¥–∞–ª:
QPay webhook –Ω—å **localhost —Ä—É—É –∏—Ä–∂ —á–∞–¥–∞—Ö–≥“Ø–π** —É—á—Ä–∞–∞—Å:
- –¢”©–ª–±”©—Ä —Ç”©–ª—Å”©–Ω —á status —à–∏–Ω—ç—á–ª—ç–≥–¥—ç—Ö–≥“Ø–π
- SMS –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä —è–≤–¥–∞–≥–≥“Ø–π
- Modal –≥–∞—Ä–∞—Ö–≥“Ø–π

### ‚úÖ –®–∏–π–¥—ç–ª: Manual Complete Button

Payment page –¥—ç—ç—Ä –æ–¥–æ–æ **"‚úÖ –¢”©–ª–±”©—Ä –¢”©–ª—Å”©–Ω (Manual Confirm + SMS)"** —Ç–æ–≤—á —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞.

---

## üß™ –¢–µ—Å—Ç –•–∏–π—Ö –ê–ª—Ö–∞–º—É—É–¥

### –•—É–≤–∏–ª–±–∞—Ä 1: Manual Complete Button (Localhost)

```
1. –ó–∞—Ö–∏–∞–ª–≥–∞ “Ø“Ø—Å–≥—ç—Ö
2. Payment page –æ—á–∏—Ö
3. QPay QR –∫–æ–¥ —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
4. (–ë–∞–Ω–∫–Ω—ã app-–∞–∞—Ä —Ç”©–ª–∂ –±–æ–ª–Ω–æ –≠–°–í–≠–õ —Ç—ç—Ä –∞–ª—Ö–º—ã–≥ –∞–ª–≥–∞—Å–∞–∂ –±–æ–ª–Ω–æ)
5. "‚úÖ –¢”©–ª–±”©—Ä –¢”©–ª—Å”©–Ω (Manual Confirm + SMS)" —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
6. Confirm –¥–∞—Ä–∞—Ö
7. üéâ Success Modal –≥–∞—Ä–Ω–∞!
8. üì± SMS —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–¥ –æ—á–Ω–æ
9. –ó–∞—Ö–∏–∞–ª–≥—ã–Ω –¥—É–≥–∞–∞—Ä —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
10. "–ù“Ø“Ø—Ä —Ö—É—É–¥–∞—Å —Ä—É—É –±—É—Ü–∞—Ö" —ç—Å–≤—ç–ª "–î–∞—Ö–∏–Ω —Ö—É–¥–∞–ª–¥–∞–Ω –∞–≤–∞—Ö" —Å–æ–Ω–≥–æ—Ö
```

### –•—É–≤–∏–ª–±–∞—Ä 2: –ë–æ–¥–∏—Ç QPay –¢”©–ª–±”©—Ä (Production Deploy)

Production server –¥—ç—ç—Ä deploy —Ö–∏–π—Å–Ω–∏–π –¥–∞—Ä–∞–∞:
```
1. QPay Dashboard ‚Üí Webhook URL —Ç–æ—Ö–∏—Ä—É—É–ª–∞—Ö:
   https://yourdomain.com/api/payment/webhook
   
2. –ó–∞—Ö–∏–∞–ª–≥–∞ “Ø“Ø—Å–≥—ç—Ö
3. QR –∫–æ–¥ –±–∞–Ω–∫–Ω—ã app-–∞–∞—Ä —É–Ω—à—É—É–ª–∞—Ö
4. –¢”©–ª–±”©—Ä —Ç”©–ª”©—Ö
5. QPay webhook –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –¥—É—É–¥–∞–≥–¥–∞–Ω–∞
6. Order status ‚Üí PAID
7. SMS –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä —è–≤–Ω–∞
8. Modal –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –≥–∞—Ä–Ω–∞
```

---

## üì± SMS –¢–µ—Å—Ç

### CallPro API:
```
API URL: https://api.messagepro.mn/send
Method: GET
Headers: x-api-key
Parameters:
  - from: 72720880
  - to: 90050576
  - text: "–¢–∞–Ω—ã ORD-... –∑–∞—Ö–∏–∞–ª–≥–∞ –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞"
```

### Manual Complete –¥–∞—Ä–∞—Ö–∞–¥:

**Terminal log:**
```
Sending SMS to: 90050576
SMS sent successfully: {"Result": "SUCCESS", "Message ID": "..."}
```

**–•—ç—Ä—ç–≤ SMS –∏—Ä—ç—Ö–≥“Ø–π –±–æ–ª:**
1. CallPro API Key —à–∞–ª–≥–∞—Ö
2. –£—Ç–∞—Å–Ω—ã –¥—É–≥–∞–∞—Ä –∑”©–≤ —ç—Å—ç—Ö (8 –æ—Ä–æ–Ω)
3. CallPro balance —à–∞–ª–≥–∞—Ö
4. Network/firewall

---

## üéâ Success Modal Features

### –•–∞—Ä–∞–≥–¥–∞—Ö –∑“Ø–π–ª—Å:
- ‚úÖ –ù–æ–≥–æ–æ–Ω checkmark icon
- ‚úÖ "–¢”©–ª–±”©—Ä –∞–º–∂–∏–ª—Ç—Ç–∞–π —Ç”©–ª”©–≥–¥–ª”©”©! üéâ"
- ‚úÖ "–¢–∞–Ω—ã –∑–∞—Ö–∏–∞–ª–≥–∞ –±–∞—Ç–∞–ª–≥–∞–∞–∂–ª–∞–∞"
- ‚úÖ –ó–∞—Ö–∏–∞–ª–≥—ã–Ω –¥—É–≥–∞–∞—Ä (–∂–Ω—å: ORD-20260212-35544)
- ‚úÖ "SMS –º—ç–¥—ç–≥–¥–ª–∏–π–≥ —Ç–∞–Ω—ã —É—Ç–∞—Å —Ä—É—É –∏–ª–≥—ç—ç–ª—ç—ç"
- ‚úÖ 2 —Ç–æ–≤—á:
  - **–ù“Ø“Ø—Ä —Ö—É—É–¥–∞—Å —Ä—É—É –±—É—Ü–∞—Ö** (primary green)
  - **–î–∞—Ö–∏–Ω —Ö—É–¥–∞–ª–¥–∞–Ω –∞–≤–∞—Ö** (outline)

### Modal —Ö–∞–∞—Ö:
- Backdrop (—Ö–∞—Ä background) –¥–∞—Ä–∞—Ö
- –ê–ª—å –Ω—ç–≥ —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∞–∞—Ä —à–∏–ª–∂–∏–Ω—ç

---

## üîÑ –£—Ä—Å–≥–∞–ª

### Development (Localhost):
```
Payment Page
   ‚Üì
QR Code —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
   ‚Üì
"‚úÖ –¢”©–ª–±”©—Ä –¢”©–ª—Å”©–Ω" —Ç–æ–≤—á –¥–∞—Ä–∞—Ö
   ‚Üì
Database: PAID –±–æ–ª–≥–æ—Ö
   ‚Üì
SMS –∏–ª–≥—ç—ç—Ö (CallPro)
   ‚Üì
üéâ Modal –≥–∞—Ä–Ω–∞!
```

### Production (Deploy):
```
Payment Page
   ‚Üì
QR Code —Ö–∞—Ä–∞–≥–¥–∞–Ω–∞
   ‚Üì
–ë–∞–Ω–∫–Ω—ã app-–∞–∞—Ä —Ç”©–ª”©—Ö
   ‚Üì
QPay webhook –¥—É—É–¥–∞–≥–¥–∞–Ω–∞
   ‚Üì
Database: PAID –±–æ–ª–≥–æ—Ö
   ‚Üì
SMS –∏–ª–≥—ç—ç—Ö (CallPro)
   ‚Üì
üéâ Modal –∞–≤—Ç–æ–º–∞—Ç–∞–∞—Ä –≥–∞—Ä–Ω–∞! (polling)
```

---

## üìä Database –®–∞–ª–≥–∞—Ö

–ó–∞—Ö–∏–∞–ª–≥—ã–Ω —Å—Ç–∞—Ç—É—Å —à–∞–ª–≥–∞—Ö:
```sql
SELECT order_number, payment_status, customer_phone 
FROM orders 
WHERE id = '0413ebfc-d8b1-435d-b4ef-994a5075118f';
```

---

## üöÄ –û–¥–æ–æ –¢—É—Ä—à–∞–∞—Ä–∞–π!

1. **Browser refresh** —Ö–∏–π—Ö
2. Payment page –¥—ç—ç—Ä **–Ω–æ–≥–æ–æ–Ω —Ç–æ–≤—á** —Ö–∞—Ä–∞–≥–¥–∞—Ö —ë—Å—Ç–æ–π
3. **"‚úÖ –¢”©–ª–±”©—Ä –¢”©–ª—Å”©–Ω"** –¥–∞—Ä–∞—Ö
4. **Modal –≥–∞—Ä–Ω–∞!**
5. **SMS —à–∞–ª–≥–∞—Ö** (—É—Ç–∞—Å –¥—ç—ç—Ä—ç—ç)

**–ê–º–∂–∏–ª—Ç!** üéØ
